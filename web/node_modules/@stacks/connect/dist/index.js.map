{"version":3,"sources":["../src/errors.ts","../src/asigna.ts","../src/providers.ts","../src/storage.ts","../src/request.ts","../src/auth.ts","../src/types/transactions.ts","../src/types/bitcoin.ts","../src/utils.ts","../src/profile/index.ts","../src/signature/index.ts","../src/signature/structuredData.ts","../src/transactions/index.ts","../src/ui.ts","../src/bitcoin/psbt.ts"],"names":["JsonRpcError","_JsonRpcError","message","code","data","cause","error","JsonRpcErrorCode","source","generateCall","payload","key","res","listener","generateAsignaMessage","AsignaIframeProvider","method","options","initializeAsignaProvider","DEFAULT_PROVIDERS","LOCAL_STORAGE_KEY","INITIAL_STORAGE","normalizeAddresses","addresses","a","_a","__objRest","setLocalStorageData","current","getLocalStorage","updated","__spreadProps","__spreadValues","bytesToHex","utf8ToBytes","clearLocalStorage","hex","bytesToUtf8","hexToBytes","disconnect","clearSelectedProviderId","UserSession","isConnected","storage","requestRaw","provider","params","response","createRequestWithStorage","enableLocalStorage","result","stx","btc","sortAddresses","acc","addr","request","args","requestArgs","opts","getProvider","shallowDefined","req","wrapResultOverrides","finalMethod","finalParams","getMethodOverrides","serializeParams","defineCustomElements","resolve","reject","element","filterProviders","getInstalledProviders","originalOverflow","closeModal","selectedProviderId","selectedProvider","getProviderFromId","proxy","createPersistProviderProxy","handleEsc","ev","approvedProviderIds","providers","p","connect","requestRawLegacy","mapOptions","mapResponse","o","r","isXverseLike","isXverse","isFordefi","isLeather","obj","value","enableOverrides","modifiedResult","base64","paramsXverse","signInputs","signRecord","input","paramsLeather","i","POST_CONDITIONS","item","postConditionToHex","Cl","shouldPersist","providerId","setSelectedProviderId","e","b","aPayment","bPayment","defaultAuthURL","isMobile","ua","authenticate","authOptions","_b","_c","_d","_e","_f","onFinish","onCancel","_userSession","userSession","getOrCreateUserSession","sessionData","address","isMainnet","btcAddress","isAddressTaproot","LOCALSTORAGE_SESSION_KEY","AppConfig","_scopes","_appDomain","_redirectPath","_manifestPath","_coreNode","_authenticatorURL","InstanceDataStore","LocalStorageStore","userData","NoSessionDataError","redirectURL","SessionDataStore","sessionOptions","_session","session","getUserData","PREFIXES","LENGTHS","index","TransactionTypes","ContractCallArgumentType","SignatureHash","getStacksProvider","getSelectedProviderId","isStacksWalletInstalled","legacyNetworkFromConnectNetwork","network","LegacyStacksNetwork","LegacyStacksMainnet","TransactionVersion","LegacyStacksTestnet","isInstance","object","clazz","connectNetworkToString","LegacyStacksDevnet","LegacyStacksMocknet","legacyCVToCV","cv","LegacyClarityType","k","v","Address","_exhaustiveCheck","removeUnserializableKeys","getDefaultProfileUpdateRequestOptions","_options","makeProfileUpdateToken","METHOD","LEGACY_UPDATE_PROFILE_OPTIONS_MAP","LEGACY_UPDATE_PROFILE_RESPONSE_MAP","openProfileUpdateRequestPopup","getDefaultSignatureRequestOptions","signMessage","LEGACY_SIGN_MESSAGE_OPTIONS_MAP","LEGACY_SIGN_MESSAGE_RESPONSE_MAP","openSignatureRequestPopup","signStructuredMessage","LEGACY_SIGN_STRUCTURED_MESSAGE_OPTIONS_MAP","LEGACY_SIGN_STRUCTURED_MESSAGE_RESPONSE_MAP","openStructuredDataSignatureRequestPopup","getUserSession","appConfig","hasAppPrivateKey","getKeys","getStxAddress","stxAddress","_network","stxAddresses","chainIdToKey","ChainId","makeContractCallToken","makeContractDeployToken","makeSTXTransferToken","makeSignTransaction","METHOD_CALL_CONTRACT","LEGACY_CALL_CONTRACT_OPTIONS_MAP","functionArgs","arg","optPostConditionMode","optPostCondition","LEGACY_CALL_CONTRACT_RESPONSE_MAP","deserializeTransaction","openContractCall","METHOD_DEPLOY_CONTRACT","LEGACY_DEPLOY_CONTRACT_OPTIONS_MAP","LEGACY_DEPLOY_CONTRACT_RESPONSE_MAP","openContractDeploy","METHOD_TRANSFER_STX","LEGACY_TRANSFER_STX_OPTIONS_MAP","LEGACY_TRANSFER_STX_RESPONSE_MAP","openSTXTransfer","METHOD_SIGN_TRANSACTION","LEGACY_SIGN_TRANSACTION_OPTIONS_MAP","LEGACY_SIGN_TRANSACTION_RESPONSE_MAP","openSignTransaction","pcs","pc","legacySerializePostCondition","mode","PostConditionMode","requestLegacy","showConnect","showSTXTransfer","showContractCall","showContractDeploy","showSignTransaction","showProfileUpdate","showSignMessage","showSignStructuredMessage","showBlockstackConnect","getDefaultPsbtRequestOptions","makePsbtToken","LEGACY_SIGN_PSBT_OPTIONS_MAP","hash","LEGACY_SIGN_PSBT_RESPONSE_MAP","openPsbtRequestPopup"],"mappings":"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","file":"index.js","sourcesContent":["import { JsonRpcResponseError } from './methods';\n\nexport class JsonRpcError extends Error {\n  constructor(\n    public message: string,\n    public code: number,\n    public data?: string,\n\n    public cause?: Error\n  ) {\n    super(message);\n    this.name = 'JsonRpcError';\n    this.message = message;\n    this.code = code;\n    this.data = data;\n\n    this.cause = cause;\n  }\n\n  static fromResponse(error: JsonRpcResponseError) {\n    return new JsonRpcError(error.message, error.code, error.data);\n  }\n\n  toString() {\n    return `${this.name} (${this.code}): ${this.message}${this.data ? `: ${JSON.stringify(this.data)}` : ''}`;\n  }\n}\n\n/**\n * Numeric error codes for JSON-RPC errors, used for `.code` in {@link JsonRpcError}.\n * Implementation-defined wallet errors range from `-32099` to `-32000`.\n */\nexport enum JsonRpcErrorCode {\n  // https://www.jsonrpc.org/specification#error_object\n  // > The error codes from and including -32768 to -32000 are reserved for pre-defined errors.\n\n  /** Invalid JSON received by server while parsing */\n  ParseError = -32_700,\n\n  /** Invalid Request object */\n  InvalidRequest = -32_600,\n\n  /** Method not found/available */\n  MethodNotFound = -32_601,\n\n  /** Invalid method params */\n  InvalidParams = -32_602,\n\n  /** Internal JSON-RPC error */\n  InternalError = -32_603,\n\n  // IMPLEMENTATION-DEFINED WALLET ERRORS\n  /** User rejected the request (implementation-defined wallet error) */\n  UserRejection = -32_000,\n\n  /** Address mismatch for the requested method (implementation-defined wallet error) */\n  MethodAddressMismatch = -32_001,\n\n  /** Access denied for the requested method (implementation-defined wallet error) */\n  MethodAccessDenied = -32_002,\n\n  // CUSTOM ERRORS (Custom range, not inside the JSON-RPC error code range)\n  /**\n   * Unknown external error.\n   * Error does not originate from the wallet.\n   */\n  UnknownError = -31_000,\n\n  /**\n   * User canceled the request.\n   * Error may not originate from the wallet.\n   */\n  UserCanceled = -31_001,\n}\n","import { MethodParams, Methods } from './methods';\n\nconst source = 'asigna-stx';\n\nconst generateCall = (payload: string | MethodParams<keyof Methods>, key: string) => {\n  return new Promise(res => {\n    function listener(message: MessageEvent<any>) {\n      if (message.data.source === source && message.data[key]) {\n        res(message.data[key]);\n        window.removeEventListener('message', listener);\n      }\n    }\n    window.addEventListener('message', listener);\n    window.top.postMessage(generateAsignaMessage(payload, key), '*');\n  });\n};\n\nconst AsignaIframeProvider = {\n  authenticationRequest: async (payload: string) => {\n    return generateCall(payload, 'authenticationRequest');\n  },\n  transactionRequest: async (payload: string) => {\n    return generateCall(payload, 'transactionRequest');\n  },\n  request: async <M extends keyof Methods>(method: M, options: MethodParams<M>) => {\n    return generateCall(options, method);\n  },\n};\n\nconst generateAsignaMessage = (payload: string | MethodParams<keyof Methods>, key: string) => ({\n  source,\n  [key]: payload,\n});\n\nexport const initializeAsignaProvider = () => {\n  if (typeof window === 'undefined') return;\n\n  const isIframe = window.top !== window.self;\n  if (isIframe) {\n    window['AsignaProvider'] = AsignaIframeProvider;\n  }\n};\n","import { WebBTCProvider } from '@stacks/connect-ui';\nimport { initializeAsignaProvider } from './asigna';\n\ninitializeAsignaProvider();\n\nexport const DEFAULT_PROVIDERS: WebBTCProvider[] = [\n  {\n    id: 'LeatherProvider',\n    name: 'Leather',\n    icon: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4IiByeD0iMjYuODM4NyIgZmlsbD0iIzEyMTAwRiIvPgo8cGF0aCBkPSJNNzQuOTE3MSA1Mi43MTE0QzgyLjQ3NjYgNTEuNTQwOCA5My40MDg3IDQzLjU4MDQgOTMuNDA4NyAzNy4zNzYxQzkzLjQwODcgMzUuNTAzMSA5MS44OTY4IDM0LjIxNTQgODkuNjg3MSAzNC4yMTU0Qzg1LjUwMDQgMzQuMjE1NCA3OC40MDYxIDQwLjUzNjggNzQuOTE3MSA1Mi43MTE0Wk0zOS45MTEgODMuNDk5MUMzMC4wMjU2IDgzLjQ5OTEgMjkuMjExNSA5My4zMzI0IDM5LjA5NjkgOTMuMzMyNEM0My41MTYzIDkzLjMzMjQgNDguODY2MSA5MS41NzY0IDUxLjY1NzMgODguNDE1N0M0Ny41ODY4IDg0LjkwMzggNDQuMjE0MSA4My40OTkxIDM5LjkxMSA4My40OTkxWk0xMDIuODI5IDc5LjI4NDhDMTAzLjQxIDk1Ljc5MDcgOTUuMDM2OSAxMDUuMDM5IDgwLjg0ODQgMTA1LjAzOUM3Mi40NzQ4IDEwNS4wMzkgNjguMjg4MSAxMDEuODc4IDU5LjMzMyA5Ni4wMjQ5QzU0LjY4MSAxMDEuMTc2IDQ1Ljg0MjMgMTA1LjAzOSAzOC41MTU0IDEwNS4wMzlDMTMuMjc4NSAxMDUuMDM5IDE0LjMyNTIgNzIuODQ2MyA0MC4wMjczIDcyLjg0NjNDNDUuMzc3MSA3Mi44NDYzIDQ5LjkxMjggNzQuMjUxMSA1NS43Mjc3IDc3Ljg4TDU5LjU2NTYgNjQuNDE3N0M0My43NDg5IDYwLjA4NjQgMzUuODQwNSA0Ny45MTE4IDQzLjYzMjYgMzAuNDY5M0g1Ni4xOTI5QzQ5LjIxNSA0Mi4wNTg2IDUzLjk4MzIgNTEuNjU3OCA2Mi44MjIgNTIuNzExNEM2Ny41OTAzIDM1LjczNzIgNzcuODI0NiAyMi41MDkgOTEuNDMxNiAyMi41MDlDOTkuMTA3NCAyMi41MDkgMTA1LjE1NSAyNy41NDI4IDEwNS4xNTUgMzYuNjczN0MxMDUuMTU1IDUxLjMwNjYgODYuMDgxOSA2My4yNDcxIDcxLjY2MDcgNjQuNDE3N0w2NS43Mjk1IDg1LjM3MjFDNzIuNDc0OCA5My4yMTUzIDkxLjE5OSAxMDAuODI0IDkxLjE5OSA3OS4yODQ4SDEwMi44MjlaIiBmaWxsPSIjRjVGMUVEIi8+Cjwvc3ZnPgo=',\n\n    webUrl: 'https://leather.io',\n    chromeWebStoreUrl:\n      'https://chrome.google.com/webstore/detail/hiro-wallet/ldinpeekobnhjjdofggfgjlcehhmanlj',\n    mozillaAddOnsUrl: 'https://leather.io/install-extension',\n  },\n  {\n    id: 'XverseProviders.BitcoinProvider',\n    name: 'Xverse Wallet',\n    icon: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MDAiIGhlaWdodD0iNjAwIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGZpbGw9IiMxNzE3MTciIGQ9Ik0wIDBoNjAwdjYwMEgweiIvPjxwYXRoIGZpbGw9IiNGRkYiIGZpbGwtcnVsZT0ibm9uemVybyIgZD0iTTQ0MCA0MzUuNHYtNTFjMC0yLS44LTMuOS0yLjItNS4zTDIyMCAxNjIuMmE3LjYgNy42IDAgMCAwLTUuNC0yLjJoLTUxLjFjLTIuNSAwLTQuNiAyLTQuNiA0LjZ2NDcuM2MwIDIgLjggNCAyLjIgNS40bDc4LjIgNzcuOGE0LjYgNC42IDAgMCAxIDAgNi41bC03OSA3OC43Yy0xIC45LTEuNCAyLTEuNCAzLjJ2NTJjMCAyLjQgMiA0LjUgNC42IDQuNUgyNDljMi42IDAgNC42LTIgNC42LTQuNlY0MDVjMC0xLjIuNS0yLjQgMS40LTMuM2w0Mi40LTQyLjJhNC42IDQuNiAwIDAgMSA2LjQgMGw3OC43IDc4LjRhNy42IDcuNiAwIDAgMCA1LjQgMi4yaDQ3LjVjMi41IDAgNC42LTIgNC42LTQuNloiLz48cGF0aCBmaWxsPSIjRUU3QTMwIiBmaWxsLXJ1bGU9Im5vbnplcm8iIGQ9Ik0zMjUuNiAyMjcuMmg0Mi44YzIuNiAwIDQuNiAyLjEgNC42IDQuNnY0Mi42YzAgNCA1IDYuMSA4IDMuMmw1OC43LTU4LjVjLjgtLjggMS4zLTIgMS4zLTMuMnYtNTEuMmMwLTIuNi0yLTQuNi00LjYtNC42TDM4NCAxNjBjLTEuMiAwLTIuNC41LTMuMyAxLjNsLTU4LjQgNTguMWE0LjYgNC42IDAgMCAwIDMuMiA3LjhaIi8+PC9nPjwvc3ZnPg==',\n\n    webUrl: 'https://xverse.app',\n    chromeWebStoreUrl:\n      'https://chrome.google.com/webstore/detail/xverse-wallet/idnnbdplmphpflfnlkomgpfbpcgelopg',\n    googlePlayStoreUrl: 'https://play.google.com/store/apps/details?id=com.secretkeylabs.xverse',\n    iOSAppStoreUrl: 'https://apps.apple.com/app/xverse-bitcoin-web3-wallet/id1552272513',\n    mozillaAddOnsUrl: 'https://www.xverse.app/download',\n  },\n  {\n    id: 'AsignaProvider',\n    name: 'Asigna Multisig',\n    icon: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMDEwMCIgZD0iTTAgMGgzMnYzMkgweiIvPjxwYXRoIGZpbGw9InVybCgjYSkiIGQ9Ik0xNS4xMSA1LjU1YTMgMyAwIDAgMC0xLjgyIDEuM2wtLjA1LjA4LS40My43Mi0uMDcuMTEtLjUuODUtLjA1LjA5LTEuMjkgMi4xOC0uMDQuMDctLjQ3LjgtLjA2LjEtLjQ2Ljc4LS4wNy4xMS0xLjYzIDIuNzYtLjA3LjExLS4zOC42Ni0uMDUuMDgtLjczIDEuMjQtLjM1LjYtLjQuNjctLjA1LjA5TDUuMSAyMC43bC0uMTEuMTgtLjE0LjIzLS4wNy4xMy0uMzMuNTUtLjA0LjA3di4wMWExLjI2IDEuMjYgMCAwIDAtLjE0LjQ3IDEuMzEgMS4zMSAwIDAgMCAxLjI0IDEuNGgxLjVsLjA1LS4wNi4wNC0uMDYuODctMS4yMS4wNS0uMDguNzctMS4wNy4wNS0uMDcuNC0uNTcuMDUtLjA2LjI0LS4zNGExLjUyIDEuNTIgMCAwIDEgMS4zOS0uNjIgMS41IDEuNSAwIDAgMSAuNjQuMiAxLjQ3IDEuNDcgMCAwIDEgLjczIDEuMjcgMS40NCAxLjQ0IDAgMCAxLS4yNy44NGwtLjYzLjg4LS4wNS4wNy0uMzIuNDUtLjA2LjA4LS4wOC4xMi0uMTIuMTYtLjA1LjA4aDIuMTNhMi4zMiAyLjMyIDAgMCAwIDEuNzctLjk2bDEuMTgtMS42My43Ny0xLjA4IDEuMy0xLjhhMS4yNCAxLjI0IDAgMCAxIC41NS0uNDNsLjA4LS4wM2ExLjMgMS4zIDAgMCAxIC4zLS4wNiAxLjI4IDEuMjggMCAwIDEgMS4xNS41NGwuMTEuMmExLjEzIDEuMTMgMCAwIDEgLjEuNDEgMS4xOSAxLjE5IDAgMCAxLS4yMy43N2wtLjAzLjA1LS41Ny44LS43Ljk4LS4yNy4zN2ExLjIyIDEuMjIgMCAwIDAtLjIuNSAxLjA1IDEuMDUgMCAwIDAtLjAyLjIzdi4wNmExLjE3IDEuMTcgMCAwIDAgLjE0LjQzbC4wMi4wNS4wNy4xYTEuNDQgMS40NCAwIDAgMCAuMS4xMWwuMDUuMDYuMDEuMDFhMS44IDEuOCAwIDAgMCAuMTQuMWMwIC4wMi4wMi4wMy4wNC4wM2ExIDEgMCAwIDAgLjA4LjA1bC4wNy4wNGExLjI1IDEuMjUgMCAwIDAgLjUuMWg2LjljLjEgMCAuMi0uMDEuMjktLjAzbC4wNi0uMDJhMS4yNyAxLjI3IDAgMCAwIC4yNy0uMS41Ny41NyAwIDAgMCAuMDctLjAzIDEuMjEgMS4yMSAwIDAgMCAuMjYtLjE5bC4wOC0uMDdhLjkyLjkyIDAgMCAwIC4xNS0uMTkgMS41NSAxLjU1IDAgMCAwIC4wOS0uMTdsLjAyLS4wNWExLjIyIDEuMjIgMCAwIDAgLjA4LS4yNnYtLjA0bC4wMi0uMDh2LS4wOGExLjMyIDEuMzIgMCAwIDAtLjItLjc0bC0xLjYtMi42NC0uMDYtLjEtLjItLjMyLS4zMy0uNTR2LS4wMWwtLjA1LS4wOC0xLjMtMi4xNS0uMDctLjEtLjA0LS4wNi0uOC0xLjMyLS4wNC0uMDctLjItLjM0LS4xLS4xNC0uMS0uMTYtLjUzLS45LS4xMy0uMi0uMDktLjE0LTIuMTctMy41Ny0uMDQtLjA3LS43Mi0xLjE5LS4wNS0uMDctLjQtLjY1YTIuNjUgMi42NSAwIDAgMC0uMy0uNCAyLjk2IDIuOTYgMCAwIDAtLjk3LS43NCAzLjA0IDMuMDQgMCAwIDAtMS4zLS4zYy0uMjUgMC0uNS4wNC0uNzQuMVoiLz48cGF0aCBmaWxsPSJ1cmwoI2IpIiBkPSJNMTkgMTYuM2E1LjQ1IDUuNDUgMCAwIDAtLjgzIDEuNTZsLS4wNC4xNWExLjM2IDEuMzYgMCAwIDEgLjI4LS4xNiAxLjI0IDEuMjQgMCAwIDEgLjM4LS4wOGguMWExLjI4IDEuMjggMCAwIDEgMS4wNS41NGMuMDQuMDYuMDguMTMuMS4yYTEuMjQgMS4yNCAwIDAgMSAuMDkuMjcgMS4xOSAxLjE5IDAgMCAxLS4yLjkxbC0uMDQuMDUtLjU3Ljc5LS43Ljk5LS4yNy4zN2ExLjIzIDEuMjMgMCAwIDAtLjIuNDIgMS4wNiAxLjA2IDAgMCAwLS4wMi4zMXYuMDZhMS4xNyAxLjE3IDAgMCAwIC4xNi40Ny45My45MyAwIDAgMCAuMDcuMSAxLjUgMS41IDAgMCAwIC4xLjEybC4wNS4wNmguMDFhMS45NCAxLjk0IDAgMCAwIC4wOS4wOCAxIDEgMCAwIDAgLjE3LjFsLjA3LjA0YTEuMjUgMS4yNSAwIDAgMCAuNS4xaDYuOWMuMSAwIC4yIDAgLjI4LS4wMmwuMDctLjAyYTEuMzIgMS4zMiAwIDAgMCAuMzQtLjEzbC4xNi0uMS4wMy0uMDNhMS4yOSAxLjI5IDAgMCAwIC4yLS4yIDIuNDMgMi40MyAwIDAgMCAuMTItLjE3Yy4wMy0uMDMuMDUtLjA4LjA3LS4xMmwuMDItLjA1YTEuMjEgMS4yMSAwIDAgMCAuMDktLjN2LS4wOGwuMDEtLjA5YTEuMzIgMS4zMiAwIDAgMC0uMi0uNzNsLTEuNi0yLjY0LS4wNi0uMS0uMi0uMzItLjMzLS41NHYtLjAybC0uMDUtLjA3LTEuMy0yLjE1LS4xMi0uMDctLjA3LS4wNGE0Ljk0IDQuOTQgMCAwIDAtMi40Ni0uNjdjLTEuMDMgMC0xLjc2LjU3LTIuMjYgMS4yWiIvPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0xMi4yOSAyMS4wOGMwIC4yOS0uMDkuNTgtLjI3Ljg0bC0xLjMxIDEuODRIN2wyLjUyLTMuNTNhMS41NCAxLjU0IDAgMCAxIDIuMS0uMzZjLjQzLjI4LjY2Ljc0LjY2IDEuMloiLz48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMTEuMTYgMjEuMjVhLjU2LjU2IDAgMCAxLS41Ny41NS41Ni41NiAwIDAgMS0uNTctLjU2LjU2LjU2IDAgMCAxIC41Ny0uNTUuNTYuNTYgMCAwIDEgLjU3LjU2WiIvPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0iYSIgeDE9IjE1LjIzIiB4Mj0iMTkuMyIgeTE9IjI1Ljc4IiB5Mj0iNi4xMSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIHN0b3AtY29sb3I9IiM2NTIyRjQiLz48c3RvcCBvZmZzZXQ9Ii41NSIgc3RvcC1jb2xvcj0iIzlCNkJGRiIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iI0E1ODVGRiIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IGlkPSJiIiB4MT0iMjIuNTkiIHgyPSIyNC44IiB5MT0iMjQuNzEiIHkyPSIxNS41MyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIHN0b3AtY29sb3I9IiM0MjFGOEIiLz48c3RvcCBvZmZzZXQ9Ii41NSIgc3RvcC1jb2xvcj0iIzcyMzBGRiIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzk3NzNGRiIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjwvc3ZnPg==',\n\n    webUrl: 'https://asigna.io',\n    chromeWebStoreUrl: 'https://stx.asigna.io/',\n  },\n  {\n    id: 'FordefiProviders.UtxoProvider',\n    name: 'Fordefi',\n\n    icon: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDIiIGhlaWdodD0iNDIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZmlsbD0iIzEwMTExNCIgZD0iTTAgMGg0MnY0MkgweiIvPgogIDxwYXRoIGQ9Ik0xOS40NyAyNi44OUg1djMuNTdhNC41NyA0LjU3IDAgMCAwIDQuNTggNC41N2g1LjgzbDQuMDYtOC4xNFoiIGZpbGw9IiM3OTk0RkYiLz4KICA8cGF0aCBkPSJNNSAxNy40aDI3LjU4bC0zLjIgNi43OEg1VjE3LjRaIiBmaWxsPSIjNDg2REZGIi8+CiAgPHBhdGggZD0iTTE0LjY3IDdINXY3LjY4aDMzVjdoLTkuNjd2NS43NGgtMlY3aC05LjY3djUuNzRoLTEuOTlWN1oiIGZpbGw9IiM1Q0QxRkEiLz4KPC9zdmc+Cg==',\n    webUrl: 'https://www.fordefi.com/',\n    chromeWebStoreUrl:\n      'https://chromewebstore.google.com/detail/fordefi/hcmehenccjdmfbojapcbcofkgdpbnlle',\n  },\n];\n","import { bytesToHex, bytesToUtf8, hexToBytes, utf8ToBytes } from '@stacks/common';\nimport { clearSelectedProviderId } from '@stacks/connect-ui';\nimport { UserSession } from './auth';\nimport { AddressEntry } from './methods';\n\nexport const LOCAL_STORAGE_KEY = '@stacks/connect';\n\nexport interface StorageData {\n  addresses: {\n    stx: Omit<AddressEntry, 'publicKey'>[];\n    btc: Omit<AddressEntry, 'publicKey'>[];\n  };\n  updatedAt?: number;\n  version: string;\n}\n\n/** @internal */\nconst INITIAL_STORAGE: StorageData = {\n  addresses: {\n    stx: [],\n    btc: [],\n  },\n  version: '0.0.1',\n};\n\n/**\n * @internal Helper to deduplicate address entries and strip sensitive data\n */\nexport const normalizeAddresses = (\n  addresses: AddressEntry[]\n): Omit<AddressEntry, 'publicKey'>[] => {\n  const deduped = [...new Map(addresses.map(a => [a.address, a])).values()];\n  return deduped.map(({ ...a }) => {\n    if ('publicKey' in a) delete a.publicKey;\n    if ('derivationPath' in a) delete a.derivationPath;\n    if ('tweakedPublicKey' in a) delete a.tweakedPublicKey;\n    return a;\n  });\n};\n\n/**\n * @internal Helper to safely store data in localStorage\n */\nexport function setLocalStorageData(data: {\n  addresses?: { stx?: AddressEntry[]; btc?: AddressEntry[] };\n}) {\n  try {\n    const existing = getLocalStorage();\n    const current: StorageData = existing || INITIAL_STORAGE;\n\n    const updated = {\n      ...current,\n      updatedAt: Date.now(),\n      addresses: {\n        ...current.addresses,\n        ...(data.addresses && {\n          stx:\n            data.addresses.stx &&\n            normalizeAddresses([\n              ...(current.addresses.stx as AddressEntry[]),\n              ...data.addresses.stx,\n            ]),\n          btc:\n            data.addresses.btc &&\n            normalizeAddresses([\n              ...(current.addresses.btc as AddressEntry[]),\n              ...data.addresses.btc,\n            ]),\n        }),\n      },\n    };\n\n    localStorage.setItem(LOCAL_STORAGE_KEY, bytesToHex(utf8ToBytes(JSON.stringify(updated))));\n  } catch (error) {\n    console.warn('Failed to store data in localStorage:', error);\n  }\n}\n\n/**\n * Clears all stored connect data from localStorage\n */\nexport function clearLocalStorage() {\n  try {\n    localStorage.removeItem(LOCAL_STORAGE_KEY);\n  } catch (error) {\n    console.warn('Failed to clear localStorage:', error);\n  }\n}\n\n/**\n * Gets the current connect data from localStorage\n */\nexport function getLocalStorage(): StorageData | null {\n  try {\n    const hex = localStorage.getItem(LOCAL_STORAGE_KEY);\n    return hex ? JSON.parse(bytesToUtf8(hexToBytes(hex))) : null;\n  } catch (error) {\n    console.warn('Failed to get data from localStorage:', error);\n    return null;\n  }\n}\n\n/** Disconnect selected wallet, clear session data and potentially clear local storage. */\nexport function disconnect() {\n  clearSelectedProviderId();\n  clearLocalStorage();\n  new UserSession().store.deleteSessionData();\n}\n\n/**\n * Checks if the user is connected.\n * Aka has successfully connected to a wallet and received an address.\n * This requires the {@link request} method to have been called with `enableLocalStorage: true`.\n */\nexport function isConnected(): boolean {\n  const storage = getLocalStorage();\n  return storage?.addresses.stx.length > 0 || storage?.addresses.btc.length > 0;\n}\n","import { base64 } from '@scure/base';\nimport { bytesToHex, hexToBytes } from '@stacks/common';\nimport {\n  getInstalledProviders,\n  getProvider,\n  getProviderFromId,\n  setSelectedProviderId,\n  WbipProvider,\n} from '@stacks/connect-ui';\nimport { defineCustomElements } from '@stacks/connect-ui/loader';\nimport { Cl, PostCondition, postConditionToHex } from '@stacks/transactions';\nimport { JsonRpcError, JsonRpcErrorCode } from './errors';\nimport {\n  AddressEntry,\n  MethodParams,\n  MethodParamsRaw,\n  MethodResult,\n  MethodResultRaw,\n  Methods,\n  MethodsRaw,\n  SendTransferParams,\n} from './methods';\nimport { DEFAULT_PROVIDERS } from './providers';\nimport { setLocalStorageData } from './storage';\nimport { StacksProvider } from './types';\n\nexport interface ConnectRequestOptions {\n  /**\n   * The provider to use for the request.\n   * If none is provided the UI will be shown.\n   * Defaults to the previously selected provider (unless `forceWalletSelect` is `true`).\n   */\n  provider?: StacksProvider;\n\n  /**\n   * Forces the user to select a wallet.\n   * Defaults to `false`.\n   */\n  forceWalletSelect?: boolean;\n\n  /**\n   * Persist the selected wallet across requests.\n   * Defaults to `true`.\n   */\n  persistWalletSelect?: boolean;\n\n  /**\n   * Adds manual request rewriting to make different providers behave more closely to SIP-030 / WBIPs.\n   * Defaults to `true`.\n   */\n  enableOverrides?: boolean;\n\n  /**\n   * Enable local storage caching of addresses.\n   * Defaults to `true`.\n   */\n  enableLocalStorage?: boolean;\n\n  /**\n   * The default wallets to display in the modal.\n   * Defaults to some known popular wallets.\n   */\n  defaultProviders?: WbipProvider[];\n\n  /**\n   * A list of provider IDs that are approved to be shown in the Stacks Connect modal.\n   * If not provided, all default and installed providers will be shown.\n   */\n  approvedProviderIds?: string[];\n\n  // todo: maybe add callbacks, if set use them instead of throwing errors\n}\n\nexport async function requestRaw<M extends keyof MethodsRaw>(\n  provider: StacksProvider,\n  method: M,\n  params?: MethodParamsRaw<M>\n): Promise<MethodResultRaw<M>> {\n  try {\n    const response = await provider.request(method, params);\n    if ('error' in response) throw JsonRpcError.fromResponse(response.error);\n\n    return response.result;\n  } catch (error) {\n    if (error instanceof JsonRpcError) throw error;\n    if ('jsonrpc' in error) throw JsonRpcError.fromResponse(error.error);\n\n    const code = error.code ?? JsonRpcErrorCode.UnknownError;\n    throw new JsonRpcError(error.message, code, error.data, error);\n  }\n}\n\n/**\n * @internal Helper function that wraps requestRaw with local storage support\n */\nfunction createRequestWithStorage(enableLocalStorage: boolean): typeof requestRaw {\n  if (!enableLocalStorage) return requestRaw;\n\n  return async function requestRawWithStorage<M extends keyof MethodsRaw>(\n    provider: StacksProvider,\n    method: M,\n    params?: MethodParamsRaw<M>\n  ): Promise<MethodResultRaw<M>> {\n    const result = await requestRaw(provider, method, params);\n    if (\n      (method === 'getAddresses' || (method as string) === 'wallet_connect') &&\n      'addresses' in result\n    ) {\n      const { stx, btc } = sortAddresses(result.addresses).reduce(\n        (acc, addr) => {\n          acc[addr.address.startsWith('S') ? 'stx' : 'btc'].push(addr);\n          return acc;\n        },\n        { stx: [], btc: [] }\n      );\n\n      setLocalStorageData({ addresses: { stx, btc } });\n    }\n    return result;\n  };\n}\n\n/**\n * The main `request` method for interacting with wallets.\n * This method adds automatic error handling, request parameter serialization, and optional local storage.\n * For more advanced use cases, consider using the {@link requestRaw} method directly.\n *\n * @example\n * ```\n * // Send BTC\n * const result = await request('sendTransfer', {\n *   recipients: [{\n *     address: 'bc1...',\n *     amount: 100_000_000n, // 1 BTC = 100,000,000 sats\n *   }],\n * });\n * ```\n *\n * @example\n * ```\n * // Optional features\n * const result = await request({\n *   provider: MyCustomProvider,\n *   defaultProviders: [MyCustomProvider, ...],\n *   forceWalletSelect: false,\n *   persistWalletSelect: true,\n *   enableOverrides: true,\n *   enableLocalStorage: true,\n * }, 'method', params);\n * ```\n */\nexport async function request<M extends keyof Methods>(\n  method: M,\n  params?: MethodParams<M>\n): Promise<MethodResult<M>>;\nexport async function request<M extends keyof Methods>(\n  options: ConnectRequestOptions,\n  method: M,\n  params?: MethodParams<M>\n): Promise<MethodResult<M>>;\nexport async function request<M extends keyof Methods>(\n  ...args:\n    | [method: M, params?: MethodParams<M>]\n    | [options: ConnectRequestOptions, method: M, params?: MethodParams<M>]\n): Promise<MethodResult<M>> {\n  const { options, method, params } = requestArgs(args);\n\n  // Default options\n  const opts = Object.assign(\n    {\n      provider: getProvider(),\n      defaultProviders: DEFAULT_PROVIDERS,\n\n      forceWalletSelect: false,\n      persistWalletSelect: true,\n      enableOverrides: true,\n      enableLocalStorage: true,\n    },\n    shallowDefined(options)\n  );\n\n  const req = wrapResultOverrides(\n    opts.enableOverrides,\n    createRequestWithStorage(opts.enableLocalStorage)\n  );\n\n  // WITHOUT UI\n  if (opts.provider && !opts.forceWalletSelect) {\n    const { method: finalMethod, params: finalParams } = getMethodOverrides(\n      opts.provider,\n      method,\n      params,\n      opts.enableOverrides\n    );\n    return await req(opts.provider, finalMethod as any, serializeParams(finalParams));\n  }\n\n  // WITH UI\n  if (typeof window === 'undefined') return undefined; // don't throw for SSR contexts\n\n  void defineCustomElements(window);\n\n  return new Promise((resolve, reject) => {\n    const element = document.createElement('connect-modal');\n    element.defaultProviders = filterProviders(opts.approvedProviderIds, opts.defaultProviders);\n    element.installedProviders = filterProviders(\n      opts.approvedProviderIds,\n      getInstalledProviders(opts.defaultProviders)\n    );\n\n    const originalOverflow = document.body.style.overflow;\n    document.body.style.overflow = 'hidden';\n\n    const closeModal = () => {\n      element.remove();\n      document.body.style.overflow = originalOverflow;\n    };\n\n    element.callback = (selectedProviderId: string | undefined) => {\n      closeModal();\n\n      const selectedProvider = getProviderFromId(selectedProviderId);\n\n      const { method: finalMethod, params: finalParams } = getMethodOverrides(\n        selectedProvider,\n        method,\n        params,\n        opts.enableOverrides\n      );\n\n      const proxy = createPersistProviderProxy(opts.persistWalletSelect, selectedProviderId);\n      resolve(req(selectedProvider, finalMethod as any, serializeParams(finalParams)).then(proxy));\n    };\n\n    element.cancelCallback = () => {\n      closeModal();\n      reject(new JsonRpcError('User canceled the request', JsonRpcErrorCode.UserCanceled));\n    };\n\n    document.body.appendChild(element);\n\n    const handleEsc = (ev: KeyboardEvent) => {\n      if (ev.key !== 'Escape') return;\n      document.removeEventListener('keydown', handleEsc);\n      element.remove();\n      reject(new JsonRpcError('User canceled the request', JsonRpcErrorCode.UserCanceled));\n    };\n    document.addEventListener('keydown', handleEsc);\n  });\n}\n\n/** @internal */\nfunction requestArgs<M extends keyof Methods>(\n  args:\n    | [method: M, params?: MethodParams<M>]\n    | [options: ConnectRequestOptions, method: M, params?: MethodParams<M>]\n): {\n  method: M;\n  params?: MethodParams<M>;\n  options?: ConnectRequestOptions;\n} {\n  if (typeof args[0] === 'string') return { method: args[0], params: args[1] as MethodParams<M> };\n  return { options: args[0], method: args[1] as M, params: args[2] };\n}\n\n/** @internal */\nfunction filterProviders(approvedProviderIds: string[], providers: WbipProvider[]): WbipProvider[] {\n  if (!approvedProviderIds) return providers;\n  return providers.filter(p => approvedProviderIds.includes(p.id));\n}\n\n/**\n * Initiate a wallet connection and request addresses.\n * Alias for `request` to `getAddresses` with `forceWalletSelect: true`.\n */\nexport function connect(options?: ConnectRequestOptions & MethodParams<'getAddresses'>) {\n  const params = options && 'network' in options ? { network: options.network } : undefined;\n  return request({ ...options, forceWalletSelect: true }, 'getAddresses', params);\n}\n\n/**\n * **Note:** Higher order function!\n * @internal Legacy non-UI request.\n */\nexport function requestRawLegacy<M extends keyof Methods, O, R>(\n  method: M,\n  mapOptions: (options: O) => MethodParams<M>,\n  mapResponse: (response: MethodResult<M>) => R\n) {\n  return (options: O, provider?: StacksProvider) => {\n    if (!provider) throw new Error('[Connect] No installed Stacks wallet found');\n\n    const params = mapOptions(options);\n\n    // Manual cast, since TypeScipt can't infer generic type of options\n    const o = options as {\n      onCancel?: (error?: Error) => void;\n      onFinish?: (response: R) => void;\n    };\n\n    const { method: finalMethod, params: finalParams } = getMethodOverrides(\n      provider,\n      method,\n      params\n    );\n\n    void requestRaw(provider, finalMethod as any, serializeParams(finalParams))\n      .then(response => {\n        const r = mapResponse(response);\n        o.onFinish?.(r);\n      })\n      .catch(o.onCancel);\n  };\n}\n\n// todo: strip params that might be unserializable or privacy sensitive, e.g.\n// appDetails?: AuthOptions['appDetails'];\n// authOrigin?: string;\n// network?: ConnectNetwork;\n// stxAddress?: string;\n// userSession?: UserSession;\n// onFinish?: ProfileUpdateFinished;\n// onCancel?: ProfileUpdateCanceled;\n\nfunction isXverseLike(provider: StacksProvider): boolean {\n  return isXverse(provider) || isFordefi(provider);\n}\n\nfunction isXverse(provider: StacksProvider): boolean {\n  return (\n    // Best effort detection for Xverse\n    'signMultipleTransactions' in provider &&\n    'createRepeatInscriptions' in provider &&\n    !provider?.['isLeather'] &&\n    !provider?.['isFordefi']\n  );\n}\n\nfunction isFordefi(provider: StacksProvider): boolean {\n  return 'isFordefi' in provider && !!provider.isFordefi;\n}\n\nfunction isLeather(provider: StacksProvider): boolean {\n  return 'isLeather' in provider && !!provider.isLeather;\n}\n\nfunction shallowDefined<T extends object>(obj: T): Partial<T> {\n  if (obj === undefined) return {};\n  const result: Partial<T> = {};\n  for (const [key, value] of Object.entries(obj)) {\n    if (value !== undefined) result[key as keyof T] = value;\n  }\n  return result;\n}\n\n/** @internal Higher-order function for proxying request results with overrides */\nfunction wrapResultOverrides<\n  M extends keyof MethodsRaw,\n  P extends MethodParamsRaw<M>,\n  R extends MethodResultRaw<M>,\n>(\n  enableOverrides: boolean,\n  request: (provider: StacksProvider, method: M, params?: P) => Promise<R>\n) {\n  if (!enableOverrides) return request;\n\n  return async (provider: StacksProvider, method: M, params?: P): Promise<R> => {\n    const result = await request(provider, method, params);\n\n    const modifiedResult = { ...result };\n\n    // Handle txId/txid case variation (Fordefi returns `txId`, others return `txid`)\n    if (result !== null && 'txId' in result && result.txId && !('txid' in modifiedResult)) {\n      (modifiedResult as any).txid = result.txId;\n    }\n\n    // Handle Leather returning `hex` instead of `psbt` (base64 encoded)\n    if (\n      result !== null &&\n      'hex' in result &&\n      result.hex &&\n      typeof result.hex === 'string' &&\n      !('psbt' in modifiedResult)\n    ) {\n      (modifiedResult as any).psbt = base64.encode(hexToBytes(result.hex));\n    }\n\n    return modifiedResult;\n  };\n}\n\nfunction getMethodOverrides<M extends keyof Methods>(\n  provider: StacksProvider,\n  method: M,\n  params?: MethodParams<M>,\n  enableOverrides: boolean = true\n): { method: string; params: any } {\n  if (!enableOverrides) return { method, params };\n\n  // Xverse-ish wallets\n  if (\n    isXverseLike(provider) &&\n    // Permission granting method\n    ['getAddresses', 'stx_getAddresses'].includes(method)\n  ) {\n    return { method: 'wallet_connect', params };\n  }\n\n  // Xverse-ish `sendTransfer`\n  if (isXverseLike(provider) && method === 'sendTransfer') {\n    const paramsXverse = {\n      ...params,\n      recipients: (params as SendTransferParams).recipients.map(r => ({\n        ...r,\n        amount: Number(r.amount), // Xverse expects amount as number\n      })),\n      network: undefined, // strip network until Xverse adds it as optional\n    };\n    return { method, params: paramsXverse };\n  }\n\n  // Xverse-ish `signPsbt`\n  if (isXverseLike(provider) && method === 'signPsbt') {\n    const signInputs = (params as MethodParams<'signPsbt'>).signInputs;\n    if (!signInputs) return { method, params };\n\n    // Transform array of SignInputsByAddress into Record<string, number[]>\n    const signRecord: Record<string, number[]> = {};\n    for (const input of signInputs) {\n      if (typeof input === 'number') continue; // Skip plain numbers\n      if (!input.address) continue; // Skip entries without address\n\n      if (!signRecord[input.address]) signRecord[input.address] = [];\n\n      signRecord[input.address].push(input.index);\n    }\n\n    const paramsXverse = {\n      psbt: (params as MethodParams<'signPsbt'>).psbt,\n      signInputs: signRecord,\n      broadcast: (params as MethodParams<'signPsbt'>).broadcast,\n      // todo: add `network` when Xverse supports it\n    };\n    return { method, params: paramsXverse };\n  }\n\n  // Non-Xverse-ish `stx_signMessage`\n  if (!isXverseLike(provider) && method === 'stx_signMessage') {\n    const p = { ...(params as MethodParams<'stx_signMessage'>) };\n    delete p.publicKey;\n    return { method, params: p };\n  }\n\n  // Leather `sendTransfer`\n  if (isLeather(provider) && method === 'sendTransfer') {\n    const paramsLeather = {\n      ...params,\n      recipients: (params as SendTransferParams).recipients.map(r => ({\n        ...r,\n        amount: r.amount.toString(), // Leather expects amount as string\n      })),\n    };\n    return { method, params: paramsLeather };\n  }\n\n  // Leather `signPsbt`\n  if (isLeather(provider) && method === 'signPsbt') {\n    const paramsLeather = {\n      hex: bytesToHex(base64.decode((params as MethodParams<'signPsbt'>).psbt)),\n      signAtIndex: (params as MethodParams<'signPsbt'>).signInputs.map(i => {\n        if (typeof i === 'number') return i;\n        return i.index;\n      }),\n      allowedSighash: (params as MethodParams<'signPsbt'>).allowedSighash,\n      broadcast: (params as MethodParams<'signPsbt'>).broadcast,\n      network: (params as MethodParams<'signPsbt'>).network,\n    };\n    return { method, params: paramsLeather };\n  }\n\n  return { method, params };\n}\n\nconst POST_CONDITIONS = [\n  'stx-postcondition',\n  'ft-postcondition',\n  'nft-postcondition',\n] satisfies PostCondition['type'][];\n\n/**\n * @internal\n * Simple function for serializing clarity object values to hex strings, in case wallets don't support them.\n */\nexport function serializeParams<M extends keyof Methods>(params: MethodParams<M>): MethodParams<M> {\n  if (!params || typeof params !== 'object') return params;\n\n  const result = { ...params };\n\n  for (const [key, value] of Object.entries(params)) {\n    // Handle bigint values\n    if (typeof value === 'bigint') {\n      result[key] = value.toString();\n      continue;\n    }\n\n    // Keep original value, don't override\n    if (!value) continue;\n\n    // Handle array of things\n    if (Array.isArray(value)) {\n      result[key] = value.map(item => {\n        if (typeof item === 'bigint') return item.toString();\n        if (!item || typeof item !== 'object' || !('type' in item)) return item;\n        if (POST_CONDITIONS.includes(item.type)) return postConditionToHex(item);\n        return Cl.serialize(item);\n      });\n      continue;\n    }\n\n    // Handle things\n    if (typeof value === 'object' && 'type' in value) {\n      result[key] = POST_CONDITIONS.includes(value.type)\n        ? // Post condition\n          postConditionToHex(value)\n        : // Clarity value\n          Cl.serialize(value);\n    }\n  }\n\n  return result;\n}\n\n/** @internal Higher order function for persisting the selected provider */\nfunction createPersistProviderProxy(shouldPersist: boolean, providerId: string) {\n  return function persistProvider<T>(result: T) {\n    if (shouldPersist) {\n      try {\n        setSelectedProviderId(providerId);\n      } catch (e) {\n        // ignore errors\n      }\n    }\n\n    return result;\n  };\n}\n\n/** @internal */\nfunction sortAddresses(addresses: AddressEntry[]) {\n  return addresses.slice().sort((a, b) => {\n    const aPayment = 'purpose' in a && a.purpose === 'payment';\n    const bPayment = 'purpose' in b && b.purpose === 'payment';\n\n    // Move payment addresses to the beginning\n    if (aPayment && !bPayment) return -1;\n    if (!aPayment && bPayment) return 1;\n    return 0;\n  });\n}\n","import { NoSessionDataError } from '@stacks/common';\nimport { request } from './request';\nimport { AuthOptions, StacksProvider } from './types';\n\n/** @deprecated Not used anymore. */\nexport const defaultAuthURL = 'https://app.blockstack.org';\n\nif (typeof window !== 'undefined') {\n  window.__CONNECT_VERSION__ = '__VERSION__'; // replaced via tsup esbuildOptions\n}\n\n/** @deprecated Will be marked as internal going forward. */\nexport const isMobile = () => {\n  const ua = navigator.userAgent;\n  if (/android/i.test(ua)) {\n    return true;\n  }\n  if (/iPad|iPhone|iPod/.test(ua)) {\n    return true;\n  }\n  return /windows phone/i.test(ua);\n};\n\n/**\n * Special `authenticate` legacy request, to store addresses in userSession matching legacy behavior.\n * @internal Legacy UI request.\n */\nexport const authenticate = async (authOptions: AuthOptions, provider?: StacksProvider) => {\n  const { onFinish, onCancel, userSession: _userSession } = authOptions;\n\n  const userSession = getOrCreateUserSession(_userSession);\n  if (userSession.isUserSignedIn()) userSession.signUserOut();\n\n  try {\n    const method = 'getAddresses';\n    const response = await request({ provider, forceWalletSelect: true }, method);\n\n    const sessionData = userSession.store.getSessionData();\n\n    // Ensure user data structure exists\n    sessionData.userData ??= { profile: {} };\n    sessionData.userData.profile ??= {};\n    sessionData.userData.profile.stxAddress ??= {\n      mainnet: '',\n      testnet: '',\n    };\n\n    // Take first STX address and use it for legacy connect user session storing.\n    const address = response.addresses\n      .find(a => a?.symbol === 'STX' || a.address.startsWith('S'))\n      .address.toUpperCase();\n    const isMainnet = address[1] === 'P' || address[1] === 'M';\n\n    Object.assign(sessionData.userData.profile.stxAddress, {\n      [isMainnet ? 'mainnet' : 'testnet']: address,\n    });\n\n    // Take first BTC address and use it for legacy connect user session storing.\n    const btcAddress = response.addresses.find(a => {\n      if (a?.address?.startsWith('S')) return false;\n      if (a['purpose'] === 'payment') return true;\n\n      // If it's taproot, only select it if no non-taproot addresses exist\n      if (isAddressTaproot(a?.address)) {\n        const onlyTaprootAddressesExist = response.addresses.every(\n          addr => addr?.address?.startsWith('S') || isAddressTaproot(addr?.address)\n        );\n        return onlyTaprootAddressesExist;\n      }\n\n      return true;\n    })?.address;\n    if (btcAddress) sessionData.userData.profile.btcAddress = btcAddress;\n\n    userSession.store.setSessionData(sessionData);\n\n    onFinish?.({ userSession, authResponsePayload: sessionData.userData });\n  } catch (error) {\n    console.error('[Connect] Error during auth request', error);\n    onCancel?.(error);\n  }\n};\n\n// Legacy User Session, User Data, etc.\n\n/** @deprecated Update to the latest `request` RPC methods. It's not recommended to use the UserSession. */\nexport const LOCALSTORAGE_SESSION_KEY = 'blockstack-session';\n\n/**\n * Semi-compatible `AppConfig` type for configuring `UserSession`.\n *\n * @deprecated Update to the latest `request` RPC methods. It's not recommended to use the UserSession.\n */\nexport class AppConfig {\n  // Copied over from legacy @stacks/auth\n  constructor(\n    _scopes?: any,\n    _appDomain?: any,\n    _redirectPath?: string,\n    _manifestPath?: string,\n    _coreNode?: string,\n    _authenticatorURL?: string\n  ) {}\n}\n\n/**\n * Semi-compatible `SessionOptions` type for accessing `userData`.\n *\n * @deprecated Update to the latest `request` RPC methods. It's not recommended to use the UserSession.\n */\nexport interface SessionOptions {\n  userData?: UserData;\n  localStorageKey?: string;\n  storeOptions?: {\n    localStorageKey?: string;\n  };\n}\n\n/**\n * Semi-compatible `SessionData` type for accessing `userData`.\n *\n * @deprecated Update to the latest `request` RPC methods. It's not recommended to use the UserSession.\n */\nexport interface SessionData {\n  userData?: UserData;\n}\n\n/**\n * Semi-compatible `UserSession` type for accessing `userData`.\n *\n * @deprecated Update to the latest `request` RPC methods. It's not recommended to use the UserSession.\n */\nexport class UserSession {\n  // Copied over from legacy @stacks/auth\n  appConfig: any;\n\n  store: SessionDataStore;\n\n  /**\n   * UserSession might still work for some use cases, but it's not recommended.\n   *\n   * @deprecated Update to the latest `request` RPC methods.\n   */\n  constructor(options?: { appConfig?: any; sessionStore?: any; sessionOptions?: SessionOptions }) {\n    if (options?.appConfig) this.appConfig = options.appConfig;\n\n    if (typeof window === 'undefined' && typeof self === 'undefined') {\n      // not running in browser\n      this.store = new InstanceDataStore();\n    } else {\n      // running in browser\n      this.store = new LocalStorageStore();\n    }\n  }\n\n  /** @deprecated No-op. Update to the latest `request` RPC methods. */\n  makeAuthRequestToken() {}\n\n  /** @deprecated No-op. Update to the latest `request` RPC methods. */\n  generateAndStoreTransitKey() {}\n\n  /** @deprecated No-op. Update to the latest `request` RPC methods. */\n  getAuthResponseToken() {}\n\n  /** @deprecated No-op. Update to the latest `request` RPC methods. */\n  isSignInPending() {\n    return false;\n  }\n\n  /**\n   * Check if a user is currently signed in.\n   *\n   * @returns {Boolean} `true` if the user is signed in (aka connected), `false` if not.\n   */\n  isUserSignedIn() {\n    return !!this.store.getSessionData().userData;\n  }\n\n  /**\n   * Try to process any pending sign in request by returning a `Promise` that resolves\n   * to the user data object if the sign in succeeds.\n   *\n   * @returns {Promise} that resolves to the user data object if successful and rejects\n   * if handling the sign in request fails or there was no pending sign in request.\n   */\n  async handlePendingSignIn(): Promise<UserData> {\n    return Promise.resolve(this.loadUserData());\n  }\n\n  /**\n   * Retrieves the user data object. The user's profile is stored in the key [[Profile]].\n   *\n   * @returns {Object} User data object.\n   */\n  loadUserData() {\n    const userData = this.store.getSessionData().userData;\n    if (!userData) throw new NoSessionDataError('No user data found. Did the user sign in?');\n    return userData;\n  }\n\n  /** @deprecated No-op. Update to the latest `request` RPC methods. */\n  encryptContent() {}\n\n  /** @deprecated No-op. Update to the latest `request` RPC methods. */\n  decryptContent() {}\n\n  /**\n   * Sign the user out and optionally redirect to given location.\n   * @param redirectURL Location to redirect user to after sign out.\n   */\n  signUserOut(redirectURL?: string) {\n    this.store.deleteSessionData();\n    if (redirectURL && typeof location !== 'undefined' && location.href) {\n      location.href = redirectURL;\n    }\n  }\n}\n\n/** @deprecated Update to the latest `request` RPC methods. It's not recommended to use the UserSession. */\nexport interface UserData {\n  /** @deprecated */\n  email?: string;\n  /** @deprecated */\n  decentralizedID?: string;\n  /** @deprecated */\n  identityAddress?: string;\n  /** @deprecated */\n  appPrivateKey?: string;\n  /** @deprecated */\n  hubUrl?: string;\n  /** @deprecated */\n  coreNode?: string;\n  /** @deprecated */\n  authResponseToken?: string;\n  /** @deprecated */\n  coreSessionToken?: string;\n  /** @deprecated */\n  gaiaAssociationToken?: string;\n  /** @deprecated */\n  profile: any;\n  /** @deprecated */\n  gaiaHubConfig?: any;\n  /** @deprecated */\n  appPrivateKeyFromWalletSalt?: string;\n}\n\n/**\n * @abstract An abstract class representing the SessionDataStore interface.\n * @deprecated Update to the latest `request` RPC methods. It's not recommended to use the UserSession.\n */\nexport class SessionDataStore {\n  constructor(sessionOptions?: SessionOptions) {\n    if (sessionOptions) this.setSessionData(sessionOptions);\n  }\n\n  getSessionData(): SessionData {\n    throw new Error('Abstract class');\n  }\n\n  setSessionData(_session: SessionData): boolean {\n    throw new Error('Abstract class');\n  }\n\n  deleteSessionData(): boolean {\n    throw new Error('Abstract class');\n  }\n}\n\n/**\n * Stores session data in the instance of this class.\n *\n * @deprecated Update to the latest `request` RPC methods. It's not recommended to use the UserSession.\n */\nexport class InstanceDataStore extends SessionDataStore {\n  sessionData?: SessionData;\n\n  constructor(sessionOptions?: SessionOptions) {\n    super(sessionOptions);\n    if (!this.sessionData) this.setSessionData({});\n  }\n\n  getSessionData(): SessionData {\n    if (!this.sessionData) throw new NoSessionDataError('No session data was found.');\n    return this.sessionData;\n  }\n\n  setSessionData(session: SessionData): boolean {\n    this.sessionData = session;\n    return true;\n  }\n\n  deleteSessionData(): boolean {\n    this.setSessionData({});\n    return true;\n  }\n}\n\n/**\n * Stores session data in browser a localStorage entry.\n *\n * @deprecated Update to the latest `request` RPC methods. It's not recommended to use the UserSession.\n */\nexport class LocalStorageStore extends SessionDataStore {\n  key: string;\n\n  constructor(sessionOptions?: SessionOptions) {\n    super(sessionOptions);\n    this.key =\n      typeof sessionOptions?.storeOptions?.localStorageKey === 'string'\n        ? sessionOptions.storeOptions.localStorageKey\n        : LOCALSTORAGE_SESSION_KEY;\n\n    const data = localStorage.getItem(this.key);\n    if (!data) this.setSessionData({});\n  }\n\n  getSessionData(): SessionData {\n    const data = localStorage.getItem(this.key);\n    if (!data) throw new NoSessionDataError('No session data was found in localStorage');\n\n    return JSON.parse(data);\n  }\n\n  setSessionData(session: SessionData): boolean {\n    localStorage.setItem(this.key, JSON.stringify(session));\n    return true;\n  }\n\n  deleteSessionData(): boolean {\n    localStorage.removeItem(this.key);\n    this.setSessionData({});\n    return true;\n  }\n}\n\n/** @deprecated Update to the latest `request` RPC methods. It's not recommended to use the UserSession. */\nexport const getOrCreateUserSession = (userSession?: UserSession): UserSession => {\n  if (userSession) return userSession;\n  return new UserSession();\n};\n\n/** @deprecated Update to the latest `request` RPC methods. It's not recommended to use the UserSession. */\nexport const getUserData = async (userSession?: UserSession) => {\n  userSession = getOrCreateUserSession(userSession);\n  if (userSession.isUserSignedIn()) return Promise.resolve(userSession.loadUserData());\n  return Promise.resolve(null);\n};\n\n/** @internal */\nexport function isAddressTaproot(address: string) {\n  const PREFIXES = ['bc1p', 'tb1p', 'bcrt1p'];\n  const LENGTHS = [62, 62, 64];\n\n  const index = PREFIXES.findIndex(p => address.startsWith(p));\n  if (index === -1) return false;\n\n  return address.length === LENGTHS[index];\n}\n","import type { AuthOptions } from '../types/auth';\nimport {\n  ClarityValue as LegacyClarityValue,\n  PostCondition as LegacyPostCondition,\n  PostConditionMode as LegacyPostConditionMode,\n} from '@stacks/transactions-v6';\nimport {\n  PostConditionMode,\n  PostCondition,\n  AnchorMode,\n  ClarityValue,\n  StacksTransactionWire,\n} from '@stacks/transactions';\nimport { ConnectNetwork } from './network';\nimport { UserSession } from '../auth';\n\nexport interface TxBase {\n  appDetails?: AuthOptions['appDetails'];\n  postConditionMode?: LegacyPostConditionMode | PostConditionMode;\n  postConditions?: (string | LegacyPostCondition | PostCondition)[];\n  network?: ConnectNetwork;\n  anchorMode?: AnchorMode;\n  attachment?: string;\n  fee?: number | string;\n  /**\n   * Provide the Hiro Wallet with a suggested account to sign this transaction with.\n   * This is set by default if a `userSession` option is provided.\n   */\n  stxAddress?: string;\n  /** @deprecated `unused - only included for compatibility with @stacks/transactions` */\n  senderKey?: string;\n  /** @deprecated `unused - only included for compatibility with @stacks/transactions` */\n  nonce?: number;\n}\n\nexport interface SignTransactionBase {\n  appDetails?: AuthOptions['appDetails'];\n  network?: ConnectNetwork;\n  attachment?: string;\n  /**\n   * Provide wallets with a suggested account to sign this transaction with.\n   * This is set by default if a `userSession` option is provided.\n   */\n  stxAddress?: string;\n  txHex: string;\n  /** @deprecated `unused - only included for compatibility with other transaction types` */\n  postConditions?: (string | LegacyPostCondition | PostCondition)[];\n}\n\nexport interface SponsoredFinishedTxPayload {\n  txRaw: string;\n}\n\nexport interface SponsoredFinishedTxData extends SponsoredFinishedTxPayload {\n  stacksTransaction: StacksTransactionWire;\n}\n\nexport interface FinishedTxPayload extends SponsoredFinishedTxPayload {\n  txId: string;\n}\n\nexport interface FinishedTxData extends FinishedTxPayload {\n  stacksTransaction: StacksTransactionWire;\n}\n\nexport enum TransactionTypes {\n  ContractCall = 'contract_call',\n  ContractDeploy = 'smart_contract',\n  STXTransfer = 'token_transfer',\n}\n\n/**\n * Contract Call\n */\n\nexport enum ContractCallArgumentType {\n  BUFFER = 'buffer',\n  UINT = 'uint',\n  INT = 'int',\n  PRINCIPAL = 'principal',\n  BOOL = 'bool',\n}\n\nexport interface ContractCallBase extends TxBase {\n  contractAddress: string;\n  contractName: string;\n  functionName: string;\n  functionArgs: (string | LegacyClarityValue | ClarityValue)[];\n}\n\nexport interface OptionsBase {\n  /**\n   * @deprecated Authentication is no longer supported through a hosted\n   * version. Users must install an extension.\n   */\n  authOrigin?: string;\n  userSession?: UserSession;\n}\n\nexport type SponsoredFinished = (data: SponsoredFinishedTxData) => void;\nexport type Finished = (data: FinishedTxData) => void;\nexport type Canceled = (error?: Error) => void;\n\nexport interface SponsoredOptionsBase extends TxBase, OptionsBase {\n  sponsored: true;\n  onFinish?: SponsoredFinished;\n  onCancel?: Canceled;\n}\n\nexport interface RegularOptionsBase extends TxBase, OptionsBase {\n  sponsored?: false;\n  onFinish?: Finished;\n  onCancel?: Canceled;\n}\n\nexport type ContractCallRegularOptions = ContractCallBase & RegularOptionsBase;\nexport type ContractCallSponsoredOptions = ContractCallBase & SponsoredOptionsBase;\nexport type ContractCallOptions = ContractCallRegularOptions | ContractCallSponsoredOptions;\n\nexport interface ContractCallArgument {\n  type: ContractCallArgumentType;\n  value: string;\n}\n\nexport interface ContractCallPayload extends ContractCallBase {\n  txType: TransactionTypes.ContractCall;\n  publicKey: string;\n  functionArgs: string[];\n  sponsored?: boolean;\n}\n\n/**\n * Contract Deploy\n */\nexport interface ContractDeployBase extends TxBase {\n  contractName: string;\n  codeBody: string;\n  /**\n   * Optional integer value to specify the Clarity version to use for this contract.\n   * Current live Clarity versions are: `1`, `2`, and `3`.\n   *\n   *  Warning: Wallets may not support this parameter yet and typically default to the latest Clarity version.\n   */\n  clarityVersion?: number;\n}\n\nexport type ContractDeployRegularOptions = ContractDeployBase & RegularOptionsBase;\nexport type ContractDeploySponsoredOptions = ContractDeployBase & SponsoredOptionsBase;\nexport type ContractDeployOptions = ContractDeployRegularOptions | ContractDeploySponsoredOptions;\n\nexport interface ContractDeployPayload extends ContractDeployBase {\n  publicKey: string;\n  txType: TransactionTypes.ContractDeploy;\n  sponsored?: boolean;\n}\n\n/**\n * STX Transfer\n */\n\nexport interface STXTransferBase extends TxBase {\n  recipient: string;\n  amount: BigInt | string;\n  memo?: string;\n}\n\nexport type STXTransferRegularOptions = STXTransferBase & RegularOptionsBase;\nexport type STXTransferSponsoredOptions = STXTransferBase & SponsoredOptionsBase;\nexport type STXTransferOptions = STXTransferRegularOptions | STXTransferSponsoredOptions;\n\nexport interface STXTransferPayload extends STXTransferBase {\n  publicKey: string;\n  txType: TransactionTypes.STXTransfer;\n  amount: string;\n  sponsored?: boolean;\n}\n\n/**\n * Transaction Popup\n */\n\nexport type TransactionOptions =\n  | ContractCallOptions\n  | ContractDeployOptions\n  | STXTransferOptions\n  | SignTransactionOptions;\nexport type TransactionPayload =\n  | ContractCallPayload\n  | ContractDeployPayload\n  | STXTransferPayload\n  | SignTransactionPayload;\n\nexport interface TransactionPopup {\n  token: string;\n  options: TransactionOptions;\n}\n\nexport interface SignTransactionOptionBase extends SignTransactionBase, OptionsBase {\n  onFinish?: SignTransactionFinished;\n  onCancel?: Canceled;\n}\n\nexport interface SignTransactionPayload extends SignTransactionBase {\n  publicKey: string;\n}\n\nexport type SignTransactionFinished = (data: SignTransactionFinishedTxData) => void;\n\nexport type SignTransactionOptions = SignTransactionOptionBase;\n\nexport interface SignTransactionFinishedTxData {\n  stacksTransaction: StacksTransactionWire;\n}\n","import { UserSession } from '../auth';\nimport { AuthOptions } from './auth';\nimport { ConnectNetwork } from './network';\n\n// Taken from @scure/btc-signer\n// https://github.com/paulmillr/scure-btc-signer\nexport enum SignatureHash {\n  DEFAULT = 0,\n  ALL = 1,\n  NONE = 2,\n  SINGLE = 3,\n  ANYONECANPAY = 0x80,\n}\n\nexport interface PsbtData {\n  hex: string;\n}\n\nexport type PsbtCanceled = (error?: Error) => void;\nexport type PsbtFinished = (data: PsbtData) => void;\n\nexport interface PsbtBase {\n  appDetails?: AuthOptions['appDetails'];\n  authOrigin?: string;\n  network?: ConnectNetwork;\n  onCancel?: PsbtCanceled;\n  onFinish?: PsbtFinished;\n  stxAddress?: string;\n  userSession?: UserSession;\n}\n\nexport interface PsbtRequestOptions extends PsbtBase {\n  allowedSighash?: SignatureHash[];\n  hex: string;\n  signAtIndex?: number | number[];\n}\n\nexport interface CommonPsbtPayload extends PsbtBase {\n  publicKey: string;\n}\n\nexport interface PsbtPayload extends CommonPsbtPayload {\n  allowedSighash?: SignatureHash[];\n  hex: string;\n  signAtIndex?: number | number[];\n}\n\n/**\n * Psbt Popup\n */\nexport interface PsbtPopup {\n  token: string;\n  options: PsbtRequestOptions;\n}\n","import { getProviderFromId, getSelectedProviderId } from '@stacks/connect-ui';\nimport { TransactionVersion } from '@stacks/network';\nimport {\n  StacksDevnet as LegacyStacksDevnet,\n  StacksMainnet as LegacyStacksMainnet,\n  StacksMocknet as LegacyStacksMocknet,\n  StacksNetwork as LegacyStacksNetwork,\n  StacksTestnet as LegacyStacksTestnet,\n} from '@stacks/network-v6';\nimport { Address, Cl, ClarityValue } from '@stacks/transactions';\nimport {\n  ClarityType as LegacyClarityType,\n  ClarityValue as LegacyClarityValue,\n} from '@stacks/transactions-v6';\nimport { ConnectNetwork } from './types';\n\n/** @deprecated This will default to the legacy provider. The behavior may be undefined with competing wallets. */\nexport function getStacksProvider() {\n  const provider = getProviderFromId(getSelectedProviderId());\n  return provider || (window as any).StacksProvider || (window as any).BlockstackProvider;\n}\n\nexport function isStacksWalletInstalled() {\n  return !!getStacksProvider();\n}\n\n/** @internal */\nexport function legacyNetworkFromConnectNetwork(network?: ConnectNetwork): LegacyStacksNetwork {\n  if (!network) return new LegacyStacksTestnet();\n  if (typeof network === 'string') return LegacyStacksNetwork.fromName(network);\n  if ('version' in network) return network; // legacy type\n\n  if ('url' in network) return new LegacyStacksMainnet({ url: network.url }); // experimental\n\n  return network.transactionVersion === (TransactionVersion.Mainnet as number)\n    ? new LegacyStacksMainnet({ url: network.client.baseUrl })\n    : new LegacyStacksTestnet({ url: network.client.baseUrl });\n}\n\nfunction isInstance<T>(object: any, clazz: { new (...args: any[]): T }): object is T {\n  return object instanceof clazz || object?.constructor?.name?.toLowerCase() === clazz.name;\n}\n\n/** @internal */\nexport function connectNetworkToString(network: ConnectNetwork): string {\n  // not perfect, but good enough to identify the legacy network in most cases\n  if (!network) return 'mainnet';\n  if (typeof network === 'string') return network;\n  if (isInstance(network, LegacyStacksMainnet)) return 'mainnet';\n  if (isInstance(network, LegacyStacksTestnet)) return 'testnet';\n  if (isInstance(network, LegacyStacksDevnet)) return 'devnet';\n  if (isInstance(network, LegacyStacksMocknet)) return 'devnet';\n\n  if ('coreApiUrl' in (network as any)) return (network as any).coreApiUrl; // in case alternate network was used\n  if ('url' in network) return network.url;\n  if ('transactionVersion' in network) {\n    return network.transactionVersion === (TransactionVersion.Mainnet as number)\n      ? 'mainnet'\n      : 'testnet';\n  }\n  return 'mainnet';\n}\n\n/**\n * @internal\n * This may be moved to Stacks.js in the future.\n */\nexport function legacyCVToCV(cv: LegacyClarityValue | ClarityValue): ClarityValue {\n  if (typeof cv.type === 'string') return cv;\n\n  switch (cv.type) {\n    case LegacyClarityType.BoolFalse:\n      return Cl.bool(false);\n    case LegacyClarityType.BoolTrue:\n      return Cl.bool(true);\n    case LegacyClarityType.Int:\n      return Cl.int(cv.value);\n    case LegacyClarityType.UInt:\n      return Cl.uint(cv.value);\n    case LegacyClarityType.Buffer:\n      return Cl.buffer(cv.buffer);\n    case LegacyClarityType.StringASCII:\n      return Cl.stringAscii(cv.data);\n    case LegacyClarityType.StringUTF8:\n      return Cl.stringUtf8(cv.data);\n    case LegacyClarityType.List:\n      return Cl.list(cv.list.map(legacyCVToCV));\n    case LegacyClarityType.Tuple:\n      return Cl.tuple(\n        Object.fromEntries(Object.entries(cv.data).map(([k, v]) => [k, legacyCVToCV(v)]))\n      );\n    case LegacyClarityType.OptionalNone:\n      return Cl.none();\n    case LegacyClarityType.OptionalSome:\n      return Cl.some(legacyCVToCV(cv.value));\n    case LegacyClarityType.ResponseErr:\n      return Cl.error(legacyCVToCV(cv.value));\n    case LegacyClarityType.ResponseOk:\n      return Cl.ok(legacyCVToCV(cv.value));\n    case LegacyClarityType.PrincipalContract:\n      return Cl.contractPrincipal(Address.stringify(cv.address), cv.contractName.content);\n    case LegacyClarityType.PrincipalStandard:\n      return Cl.standardPrincipal(Address.stringify(cv.address));\n    default:\n      const _exhaustiveCheck: never = cv;\n      throw new Error(`Unknown clarity type: ${_exhaustiveCheck}`);\n  }\n}\n\n/** @internal */\nexport function removeUnserializableKeys<O>(\n  obj: O | { onFinish?: Function; onCancel?: Function }\n): O {\n  return {\n    ...obj,\n    onFinish: undefined,\n    onCancel: undefined,\n  } as O;\n}\n","import { PublicPersonProfile } from '@stacks/profile';\nimport { MethodParams, MethodResult } from '../methods';\nimport { requestRawLegacy } from '../request';\nimport { ProfileUpdateRequestOptions, StacksProvider } from '../types';\nimport { getStacksProvider } from '../utils';\n\n/** @deprecated No-op. Tokens are not needed for latest RPC endpoints. */\nexport function getDefaultProfileUpdateRequestOptions(_options: ProfileUpdateRequestOptions) {}\n\n/** @deprecated No-op. Tokens are not needed for latest RPC endpoints. */\nexport const makeProfileUpdateToken = async (_options: ProfileUpdateRequestOptions) => {};\n\nconst METHOD = 'stx_updateProfile' as const;\n\n/** @internal */\nexport const LEGACY_UPDATE_PROFILE_OPTIONS_MAP = (\n  options: ProfileUpdateRequestOptions\n): MethodParams<typeof METHOD> => options;\n\n/** @internal */\nexport const LEGACY_UPDATE_PROFILE_RESPONSE_MAP = (\n  response: MethodResult<typeof METHOD>\n): PublicPersonProfile => response.profile as PublicPersonProfile;\n\n/** Compatible interface with previous Connect `openProfileUpdateRequestPopup` version, but using new SIP-030 RPC method. */\nexport function openProfileUpdateRequestPopup(\n  options: ProfileUpdateRequestOptions,\n  provider: StacksProvider = getStacksProvider()\n) {\n  requestRawLegacy(\n    METHOD,\n    LEGACY_UPDATE_PROFILE_OPTIONS_MAP,\n    LEGACY_UPDATE_PROFILE_RESPONSE_MAP\n  )(options, provider);\n}\n","import { MethodParams, MethodResult } from '../methods';\nimport { requestRawLegacy } from '../request';\nimport { StacksProvider } from '../types';\nimport {\n  CommonSignatureRequestOptions,\n  SignatureData,\n  SignatureRequestOptions,\n} from '../types/signature';\nimport { getStacksProvider } from '../utils';\n\n/** @deprecated No-op. Tokens are not needed for latest RPC endpoints. */\nexport function getDefaultSignatureRequestOptions(_options: CommonSignatureRequestOptions) {}\n\nexport interface SignatureRequestPayload {\n  message: string;\n}\n\n/** @deprecated No-op. Tokens are not needed for latest RPC endpoints. */\nexport const signMessage = async (_options: SignatureRequestOptions) => {};\n\nconst METHOD = 'stx_signMessage' as const;\n\n/** @internal */\nexport const LEGACY_SIGN_MESSAGE_OPTIONS_MAP = (\n  options: SignatureRequestOptions\n): MethodParams<typeof METHOD> => options;\n\n/** @internal */\nexport const LEGACY_SIGN_MESSAGE_RESPONSE_MAP = (\n  response: MethodResult<typeof METHOD>\n): SignatureData => response;\n\n/** Compatible interface with previous Connect `openSignatureRequestPopup` version, but using new SIP-030 RPC method. */\nexport function openSignatureRequestPopup(\n  options: SignatureRequestOptions,\n  provider: StacksProvider = getStacksProvider()\n) {\n  requestRawLegacy(\n    METHOD,\n    LEGACY_SIGN_MESSAGE_OPTIONS_MAP,\n    LEGACY_SIGN_MESSAGE_RESPONSE_MAP\n  )(options, provider);\n}\n","import { TupleCV } from '@stacks/transactions';\nimport { ClarityType as LegacyClarityType } from '@stacks/transactions-v6';\nimport { MethodParams, MethodResult } from '../methods';\nimport { requestRawLegacy } from '../request';\nimport { SignatureData, StacksProvider } from '../types';\nimport { StructuredDataSignatureRequestOptions } from '../types/structuredDataSignature';\nimport { getStacksProvider, legacyCVToCV } from '../utils';\n\n/** @deprecated No-op. Tokens are not needed for latest RPC endpoints. */\nexport async function signStructuredMessage(_options: StructuredDataSignatureRequestOptions) {}\n\nconst METHOD = 'stx_signStructuredMessage' as const;\n\n/** @internal */\nexport const LEGACY_SIGN_STRUCTURED_MESSAGE_OPTIONS_MAP = (\n  options: StructuredDataSignatureRequestOptions\n): MethodParams<typeof METHOD> => ({\n  // todo: also make sure that cvs don't have bigint unserializable values\n  message: legacyCVToCV(options.message),\n  domain: legacyCVToCV(options.domain) as TupleCV, // safe cast, because of below check\n});\n\n/** @internal */\nexport const LEGACY_SIGN_STRUCTURED_MESSAGE_RESPONSE_MAP = (\n  response: MethodResult<typeof METHOD>\n): SignatureData => response;\n\n/** Compatible interface with previous Connect `openStructuredDataSignatureRequestPopup` version, but using new SIP-030 RPC method. */\nexport function openStructuredDataSignatureRequestPopup(\n  options: StructuredDataSignatureRequestOptions,\n  provider: StacksProvider = getStacksProvider()\n): void {\n  if (options.domain.type !== LegacyClarityType.Tuple) {\n    throw new Error('Domain must be a tuple'); // check, ensures domain is a tuple\n  }\n\n  requestRawLegacy(\n    METHOD,\n    LEGACY_SIGN_STRUCTURED_MESSAGE_OPTIONS_MAP,\n    LEGACY_SIGN_STRUCTURED_MESSAGE_RESPONSE_MAP\n  )(options, provider);\n}\n","import { bytesToHex } from '@stacks/common';\nimport { ChainId } from '@stacks/network';\nimport {\n  Cl,\n  deserializeTransaction,\n  PostCondition,\n  PostConditionMode,\n  PostConditionModeName,\n} from '@stacks/transactions';\nimport {\n  PostCondition as LegacyPostCondition,\n  serializePostCondition as legacySerializePostCondition,\n} from '@stacks/transactions-v6';\nimport { MethodParams, MethodResult } from '../methods';\nimport { requestRawLegacy } from '../request';\nimport { StacksProvider } from '../types';\nimport {\n  ContractCallOptions,\n  ContractCallRegularOptions,\n  ContractCallSponsoredOptions,\n  ContractDeployOptions,\n  FinishedTxData,\n  SignTransactionFinishedTxData,\n  SignTransactionOptions,\n  SponsoredFinishedTxData,\n  STXTransferOptions,\n  STXTransferRegularOptions,\n  STXTransferSponsoredOptions,\n  TransactionOptions,\n} from '../types/transactions';\nimport {\n  connectNetworkToString,\n  getStacksProvider,\n  legacyCVToCV,\n  legacyNetworkFromConnectNetwork,\n} from '../utils';\nimport { AppConfig, UserSession } from '../auth';\n\n/** @deprecated Update to the latest `request` RPC methods. It's not recommended to use the UserSession. */\nexport const getUserSession = (_userSession?: UserSession) => {\n  let userSession = _userSession;\n\n  if (!userSession) {\n    const appConfig = new AppConfig(['store_write'], document.location.href);\n    userSession = new UserSession({ appConfig });\n  }\n  return userSession;\n};\n\n/** @deprecated Update to the latest `request` RPC methods. It's not recommended to use the UserSession. */\nexport function hasAppPrivateKey(userSession?: UserSession) {\n  try {\n    const session = getUserSession(userSession).loadUserData();\n    return session.appPrivateKey;\n  } catch (e) {\n    return false;\n  }\n}\n\n/** @deprecated No-op. Update to the latest `request` RPC methods. */\nexport const getKeys = (_userSession?: UserSession) => {};\n\n/** @deprecated Update to the latest `request` RPC methods. It's not recommended to use the UserSession. */\nexport function getStxAddress(options: TransactionOptions) {\n  const { stxAddress, userSession, network: _network } = options;\n\n  if (stxAddress) return stxAddress;\n  if (!userSession || !_network) return undefined;\n  const stxAddresses = userSession?.loadUserData().profile?.stxAddress;\n\n  const chainIdToKey = {\n    [ChainId.Mainnet]: 'mainnet',\n    [ChainId.Testnet]: 'testnet',\n  };\n  const network = legacyNetworkFromConnectNetwork(_network);\n  const address: string | undefined = stxAddresses?.[chainIdToKey[network.chainId]];\n  return address;\n}\n\n/** @deprecated No-op. Tokens are not needed for latest RPC endpoints. */\nexport const makeContractCallToken = async (_options: ContractCallOptions) => {};\n\n/** @deprecated No-op. Tokens are not needed for latest RPC endpoints. */\nexport const makeContractDeployToken = async (_options: ContractDeployOptions) => {};\n\n/** @deprecated No-op. Tokens are not needed for latest RPC endpoints. */\nexport const makeSTXTransferToken = async (_options: STXTransferOptions) => {};\n\n/** @deprecated No-op. Tokens are not needed for latest RPC endpoints. */\nexport const makeSignTransaction = async (_options: SignTransactionOptions) => {};\n\n// # TRANSACTION METHODS\n\n// ## Contract Call\n\nconst METHOD_CALL_CONTRACT = 'stx_callContract' as const;\n\n/** @internal */\nexport const LEGACY_CALL_CONTRACT_OPTIONS_MAP = (\n  options: ContractCallOptions\n): MethodParams<typeof METHOD_CALL_CONTRACT> => {\n  const functionArgs = options.functionArgs\n    ?.map(arg => {\n      if (typeof arg === 'string') return Cl.deserialize(arg);\n      return legacyCVToCV(arg);\n    })\n    // serialize to hex, since some wallets expect hex-encoded args\n    .map(arg => Cl.serialize(arg));\n\n  return {\n    ...options,\n    contract: `${options.contractAddress}.${options.contractName}`,\n    functionArgs,\n    network: connectNetworkToString(options.network),\n    postConditionMode: optPostConditionMode(options.postConditionMode),\n    postConditions: optPostCondition(options.postConditions),\n    address: options.stxAddress,\n  };\n};\n\n/** @internal */\nexport const LEGACY_CALL_CONTRACT_RESPONSE_MAP = (\n  response: MethodResult<typeof METHOD_CALL_CONTRACT>\n): FinishedTxData | SponsoredFinishedTxData => ({\n  txId: response.txid,\n  txRaw: response.transaction,\n  stacksTransaction: deserializeTransaction(response.transaction),\n});\n\n/** Compatible interface with previous Connect `openContractCall` version, but using new SIP-030 RPC method. */\nexport function openContractCall(\n  options: ContractCallOptions | ContractCallRegularOptions | ContractCallSponsoredOptions,\n  provider: StacksProvider = getStacksProvider()\n) {\n  requestRawLegacy(\n    METHOD_CALL_CONTRACT,\n    LEGACY_CALL_CONTRACT_OPTIONS_MAP,\n    LEGACY_CALL_CONTRACT_RESPONSE_MAP\n  )(options, provider);\n}\n\n// ## Contract Deploy\n\nconst METHOD_DEPLOY_CONTRACT = 'stx_deployContract' as const;\n\n/** @internal */\nexport const LEGACY_DEPLOY_CONTRACT_OPTIONS_MAP = (\n  options: ContractDeployOptions\n): MethodParams<typeof METHOD_DEPLOY_CONTRACT> => ({\n  ...options,\n  name: options.contractName,\n  clarityCode: options.codeBody,\n  network: connectNetworkToString(options.network),\n  postConditionMode: optPostConditionMode(options.postConditionMode),\n  postConditions: optPostCondition(options.postConditions),\n  address: options.stxAddress,\n});\n\n/** @internal */\nexport const LEGACY_DEPLOY_CONTRACT_RESPONSE_MAP = (\n  response: MethodResult<typeof METHOD_DEPLOY_CONTRACT>\n): FinishedTxData | SponsoredFinishedTxData => ({\n  txId: response.txid,\n  txRaw: response.transaction,\n  stacksTransaction: deserializeTransaction(response.transaction),\n});\n\n/** Compatible interface with previous Connect `openContractDeploy` version, but using new SIP-030 RPC method. */\nexport function openContractDeploy(\n  options: ContractDeployOptions,\n  provider: StacksProvider = getStacksProvider()\n) {\n  requestRawLegacy(\n    METHOD_DEPLOY_CONTRACT,\n    LEGACY_DEPLOY_CONTRACT_OPTIONS_MAP,\n    LEGACY_DEPLOY_CONTRACT_RESPONSE_MAP\n  )(options, provider);\n}\n\n// ## STX Transfer\n\nconst METHOD_TRANSFER_STX = 'stx_transferStx' as const;\n\n/** @internal */\nexport const LEGACY_TRANSFER_STX_OPTIONS_MAP = (\n  options: STXTransferOptions\n): MethodParams<typeof METHOD_TRANSFER_STX> => ({\n  ...options,\n  amount: options.amount.toString(),\n  network: connectNetworkToString(options.network),\n  address: options.stxAddress,\n});\n\n/** @internal */\nexport const LEGACY_TRANSFER_STX_RESPONSE_MAP = (\n  response: MethodResult<typeof METHOD_TRANSFER_STX>\n): FinishedTxData | SponsoredFinishedTxData => ({\n  txId: response.txid,\n  txRaw: response.transaction,\n  stacksTransaction: deserializeTransaction(response.transaction),\n});\n\n/** Compatible interface with previous Connect `openSTXTransfer` version, but using new SIP-030 RPC method. */\nexport function openSTXTransfer(\n  options: STXTransferOptions | STXTransferRegularOptions | STXTransferSponsoredOptions,\n  provider: StacksProvider = getStacksProvider()\n) {\n  requestRawLegacy(\n    METHOD_TRANSFER_STX,\n    LEGACY_TRANSFER_STX_OPTIONS_MAP,\n    LEGACY_TRANSFER_STX_RESPONSE_MAP\n  )(options, provider);\n}\n\n// ## Sign Transaction\n\nconst METHOD_SIGN_TRANSACTION = 'stx_signTransaction' as const;\n\n/** @internal */\nexport const LEGACY_SIGN_TRANSACTION_OPTIONS_MAP = (\n  options: SignTransactionOptions\n): MethodParams<typeof METHOD_SIGN_TRANSACTION> => ({\n  ...options,\n  transaction: options.txHex,\n});\n\n/** @internal */\nexport const LEGACY_SIGN_TRANSACTION_RESPONSE_MAP = (\n  response: MethodResult<typeof METHOD_SIGN_TRANSACTION>\n): SignTransactionFinishedTxData => ({\n  ...response, // additional fields, in case previous type was incorrect\n  stacksTransaction: deserializeTransaction(response.transaction),\n});\n\n/** Compatible interface with previous Connect `openSignTransaction` version, but using new SIP-030 RPC method. */\nexport function openSignTransaction(\n  options: SignTransactionOptions,\n  provider: StacksProvider = getStacksProvider()\n) {\n  requestRawLegacy(\n    METHOD_SIGN_TRANSACTION,\n    LEGACY_SIGN_TRANSACTION_OPTIONS_MAP,\n    LEGACY_SIGN_TRANSACTION_RESPONSE_MAP\n  )(options, provider);\n}\n\n// ## Helpers\n\n/** @internal */\nfunction optPostCondition(pcs?: (string | LegacyPostCondition | PostCondition)[]) {\n  if (typeof pcs === 'undefined') return undefined;\n  return pcs.map(pc => {\n    if (typeof pc === 'string') return pc;\n    if (typeof pc.type === 'string') {\n      return {\n        ...pc,\n        amount: 'amount' in pc ? pc.amount.toString() : undefined, // ensure amount is not bigint\n      };\n    }\n    return bytesToHex(legacySerializePostCondition(pc));\n  });\n}\n\n/** @internal */\nfunction optPostConditionMode(mode?: PostConditionModeName | PostConditionMode) {\n  if (typeof mode === 'undefined') return undefined;\n  if (typeof mode === 'string') return mode;\n  switch (mode) {\n    case PostConditionMode.Allow:\n      return 'allow';\n    case PostConditionMode.Deny:\n      return 'deny';\n    default:\n      const _exhaustiveCheck: never = mode;\n      throw new Error(\n        `Unknown post condition mode: ${_exhaustiveCheck}. Should be one of: 'allow', 'deny'`\n      );\n  }\n}\n","import { authenticate } from './auth';\nimport { MethodParams, MethodResult, Methods } from './methods';\nimport { LEGACY_UPDATE_PROFILE_OPTIONS_MAP, LEGACY_UPDATE_PROFILE_RESPONSE_MAP } from './profile';\nimport { request } from './request';\nimport { LEGACY_SIGN_MESSAGE_OPTIONS_MAP, LEGACY_SIGN_MESSAGE_RESPONSE_MAP } from './signature';\nimport {\n  LEGACY_SIGN_STRUCTURED_MESSAGE_OPTIONS_MAP,\n  LEGACY_SIGN_STRUCTURED_MESSAGE_RESPONSE_MAP,\n} from './signature/structuredData';\nimport {\n  LEGACY_CALL_CONTRACT_OPTIONS_MAP,\n  LEGACY_CALL_CONTRACT_RESPONSE_MAP,\n  LEGACY_DEPLOY_CONTRACT_OPTIONS_MAP,\n  LEGACY_DEPLOY_CONTRACT_RESPONSE_MAP,\n  LEGACY_SIGN_TRANSACTION_OPTIONS_MAP,\n  LEGACY_SIGN_TRANSACTION_RESPONSE_MAP,\n  LEGACY_TRANSFER_STX_OPTIONS_MAP,\n  LEGACY_TRANSFER_STX_RESPONSE_MAP,\n} from './transactions';\nimport { StacksProvider } from './types';\nimport { removeUnserializableKeys } from './utils';\n\n/**\n * **Note:** Higher order function!\n * @internal Legacy UI request.\n */\nfunction requestLegacy<M extends keyof Methods, O, R>(\n  method: M,\n  mapOptions: (options: O) => MethodParams<M>,\n  mapResponse: (response: MethodResult<M>) => R\n) {\n  return (options: O, provider?: StacksProvider) => {\n    const params = mapOptions(removeUnserializableKeys(options));\n\n    // Manual cast, since TypeScipt can't infer generic type of options\n    const o = options as {\n      onCancel?: (error?: Error) => void;\n      onFinish?: (response: R) => void;\n    };\n\n    void request({ provider }, method, params)\n      .then(response => {\n        const r = mapResponse(response);\n        o.onFinish?.(r);\n      })\n      .catch(e => {\n        console.error(e); // todo: remove again? or maybe keep for legacy debugging\n        o.onCancel?.(e);\n      });\n  };\n}\n\n// BACKWARDS COMPATIBILITY\n\n/** A wrapper for selecting a wallet (if none is selected) and then calling the {@link authenticate} action. */\nexport const showConnect = authenticate;\n\n/** A wrapper for selecting a wallet (if none is selected) and then calling the {@link openSTXTransfer} action. */\nexport const showSTXTransfer = requestLegacy(\n  'stx_transferStx',\n  LEGACY_TRANSFER_STX_OPTIONS_MAP,\n  LEGACY_TRANSFER_STX_RESPONSE_MAP\n);\n\n/** A wrapper for selecting a wallet (if none is selected) and then calling the {@link openContractCall} action. */\nexport const showContractCall = requestLegacy(\n  'stx_callContract',\n  LEGACY_CALL_CONTRACT_OPTIONS_MAP,\n  LEGACY_CALL_CONTRACT_RESPONSE_MAP\n);\n\n/** A wrapper for selecting a wallet (if none is selected) and then calling the {@link openContractDeploy} action. */\nexport const showContractDeploy = requestLegacy(\n  'stx_deployContract',\n  LEGACY_DEPLOY_CONTRACT_OPTIONS_MAP,\n  LEGACY_DEPLOY_CONTRACT_RESPONSE_MAP\n);\n\n/** A wrapper for selecting a wallet (if none is selected) and then calling the {@link openSignTransaction} action. */\nexport const showSignTransaction = requestLegacy(\n  'stx_signTransaction',\n  LEGACY_SIGN_TRANSACTION_OPTIONS_MAP,\n  LEGACY_SIGN_TRANSACTION_RESPONSE_MAP\n);\n\n/** A wrapper for selecting a wallet (if none is selected) and then calling the {@link openProfileUpdateRequestPopup} action. */\nexport const showProfileUpdate = requestLegacy(\n  'stx_updateProfile',\n  LEGACY_UPDATE_PROFILE_OPTIONS_MAP,\n  LEGACY_UPDATE_PROFILE_RESPONSE_MAP\n);\n\n/** A wrapper for selecting a wallet (if none is selected) and then calling the {@link openSignatureRequestPopup} action. */\nexport const showSignMessage = requestLegacy(\n  'stx_signMessage',\n  LEGACY_SIGN_MESSAGE_OPTIONS_MAP,\n  LEGACY_SIGN_MESSAGE_RESPONSE_MAP\n);\n\n/** A wrapper for selecting a wallet (if none is selected) and then calling the {@link openStructuredDataSignatureRequestPopup} action. */\nexport const showSignStructuredMessage = requestLegacy(\n  'stx_signStructuredMessage',\n  LEGACY_SIGN_STRUCTURED_MESSAGE_OPTIONS_MAP,\n  LEGACY_SIGN_STRUCTURED_MESSAGE_RESPONSE_MAP\n);\n\nexport { getProvider as getSelectedProvider, isProviderSelected } from '@stacks/connect-ui';\n\n/**\n * @deprecated Use the renamed {@link showConnect} method\n */\nexport const showBlockstackConnect = showConnect;\n","import { base64 } from '@scure/base';\nimport { bytesToHex, hexToBytes } from '@stacks/common';\nimport { MethodParams, MethodResult, Sighash } from '../methods';\nimport { requestRawLegacy } from '../request';\nimport { StacksProvider } from '../types';\nimport { PsbtData, PsbtRequestOptions, SignatureHash } from '../types/bitcoin';\nimport { getStacksProvider } from '../utils';\n\n/** @deprecated No-op. Tokens are not needed for latest RPC endpoints. */\nexport function getDefaultPsbtRequestOptions(_options: PsbtRequestOptions) {}\n\n/** @deprecated No-op. Tokens are not needed for latest RPC endpoints. */\nexport const makePsbtToken = async (_options: PsbtRequestOptions) => {};\n\nconst METHOD = 'signPsbt' as const;\n\n/** @internal */\nexport const LEGACY_SIGN_PSBT_OPTIONS_MAP = (\n  options: PsbtRequestOptions\n): MethodParams<typeof METHOD> => ({\n  psbt: base64.encode(hexToBytes(options.hex)),\n  signInputs: typeof options.signAtIndex === 'number' ? [options.signAtIndex] : options.signAtIndex,\n  allowedSighash: options.allowedSighash?.map(hash => SignatureHash[hash] as Sighash),\n});\n\n/** @internal */\nexport const LEGACY_SIGN_PSBT_RESPONSE_MAP = (response: MethodResult<typeof METHOD>): PsbtData => ({\n  hex: bytesToHex(base64.decode(response.psbt)),\n});\n\n/**\n * @experimental\n * Compatible interface with previous Connect `openPsbtRequestPopup` version, but using new SIP-030 RPC method.\n */\nexport function openPsbtRequestPopup(\n  options: PsbtRequestOptions,\n  provider: StacksProvider = getStacksProvider()\n) {\n  requestRawLegacy(\n    METHOD,\n    LEGACY_SIGN_PSBT_OPTIONS_MAP,\n    LEGACY_SIGN_PSBT_RESPONSE_MAP\n  )(options, provider);\n}\n"]}